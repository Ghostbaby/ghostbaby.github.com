<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[GhostBaby`s Area]]></title>
  <link href="http://Ghostbaby.github.io/atom.xml" rel="self"/>
  <link href="http://Ghostbaby.github.io/"/>
  <updated>2013-08-30T14:53:50+08:00</updated>
  <id>http://Ghostbaby.github.io/</id>
  <author>
    <name><![CDATA[GhostBaby]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Svn limit update size]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/30/svn-limit-update-size/"/>
    <updated>2013-08-30T14:50:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/30/svn-limit-update-size</id>
    <content type="html"><![CDATA[<p>Need hooks</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/bash
</span><span class='line'>REPOS="$1"
</span><span class='line'>TXN="$2"
</span><span class='line'>RES="OK"
</span><span class='line'>MAX_SIZE=5120000
</span><span class='line'>FILTER='\.(zip|rar|o|obj|tar|gz)$'
</span><span class='line'> 
</span><span class='line'># Make sure that the log message contains some text.
</span><span class='line'>SVNLOOK=/usr/bin/svnlook
</span><span class='line'>#SVNLOOK=/opt/CollabNet_Subversion/bin/svnlook
</span><span class='line'>
</span><span class='line'>$SVNLOOK log -t "$TXN" "$REPOS" | egrep  "[^[:space:]]+" &gt;/dev/null || unset RES 
</span><span class='line'>if [ "$RES" != "OK" ]
</span><span class='line'>then
</span><span class='line'>echo "You must input some comments for you commit" &gt;&2
</span><span class='line'>exit 1
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>files=$($SVNLOOK changed -t $TXN $REPOS |awk '{print $2}')
</span><span class='line'>
</span><span class='line'>for f in $files
</span><span class='line'>do
</span><span class='line'>#check file type
</span><span class='line'>if echo $f|tr A-Z a-z|grep -Eq $FILTER
</span><span class='line'>then
</span><span class='line'>echo "File $f is not allow ($FILTER) file" &gt;&2
</span><span class='line'>exit 1
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>#check file size
</span><span class='line'>filesize=$($SVNLOOK cat -t $TXN $REPOS $f|wc -c)
</span><span class='line'>if [ "$filesize" -gt "$MAX_SIZE" ]
</span><span class='line'>then
</span><span class='line'>echo "File $f is too large(must &lt;=$MAX_SIZE)" &gt;&2
</span><span class='line'>exit 1
</span><span class='line'>fi
</span><span class='line'>done
</span><span class='line'>
</span><span class='line'># All checks passed, so allow the commit.
</span><span class='line'>exit 0</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用SHELL脚本来防止SSH和vsftpd暴力破解]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/yong-shelljiao-ben-lai-fang-zhi-sshhe-vsftpdbao-li-po-jie/"/>
    <updated>2013-08-29T09:36:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/yong-shelljiao-ben-lai-fang-zhi-sshhe-vsftpdbao-li-po-jie</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#! /bin/bash
</span><span class='line'>cat /var/log/secure|awk '/Failed/{print $(NF-3)}'|sort|uniq -c|awk '{print $2"="$1;}' &gt; /root/black.txt
</span><span class='line'>DEFINE="100"
</span><span class='line'>for i in `cat /root/black.txt`
</span><span class='line'>do
</span><span class='line'>IP=`echo $i |awk -F= '{print $1}'`
</span><span class='line'>NUM=`echo $i|awk -F= '{print $2}'`
</span><span class='line'>if [ $NUM -gt $DEFINE ];
</span><span class='line'>then
</span><span class='line'>grep $IP /etc/hosts.deny &gt; /dev/null
</span><span class='line'>if [ $? -gt 0 ];
</span><span class='line'>then
</span><span class='line'>echo "sshd:$IP" &gt;&gt; /etc/hosts.deny
</span><span class='line'>echo "vsftpd:$IP" &gt;&gt; /etc/hosts.deny
</span><span class='line'>fi
</span><span class='line'>fi
</span><span class='line'>done</span></code></pre></td></tr></table></div></figure>


<p>脚本思路如下：</p>

<pre><code> 由于/var/log/secure是以星期为轮询的，所以我们每次可以查看这个文件，利用SHELL脚本统计出其中访问失败比较频繁的IP，并定义一个阀值为100，如果大于100的话就将其放进/etc/hosts.deny文件，阻止其继续访问vsftpd和ssh;然后将其写进crontab计划列表里，每隔一段时间进行一次排查，如果下次排查的某IP次数又大于100，首先检查它在不在我们的黑名单，如果在的话就无视过去;如果不在，就继续添加进/etc/hosts.deny文件。
</code></pre>

<p>   我的/etc/crontab文件最后一行为</p>

<ul>
<li><p>*/1 * * * root sh /root/hosts_deny.sh</p>

<p>   即每隔1小时就重复执行一次这个脚本，这里也有一个情况要说明下，/var/log/secure是每隔一个星期轮询一次的，所以我们这里可以根据服务器的具体情况来配置多少时间执行一次此脚本，暴力破解频繁的机器可适当缩小这个周期。</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux服务器安全初始化Shell脚本]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/linuxfu-wu-qi-an-quan-chu-shi-hua-shelljiao-ben/"/>
    <updated>2013-08-29T09:34:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/linuxfu-wu-qi-an-quan-chu-shi-hua-shelljiao-ben</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/sh
</span><span class='line'># desc: setup linux system security
</span><span class='line'># author:coralzd
</span><span class='line'># powered by www.freebsdsystem.org
</span><span class='line'># version 0.1.2 written by 2011.05.03
</span><span class='line'>
</span><span class='line'>#设置账号
</span><span class='line'>passwd -l xfs
</span><span class='line'>passwd -l news
</span><span class='line'>passwd -l nscd
</span><span class='line'>passwd -l dbus
</span><span class='line'>passwd -l vcsa
</span><span class='line'>passwd -l games
</span><span class='line'>passwd -l nobody
</span><span class='line'>passwd -l avahi
</span><span class='line'>passwd -l haldaemon
</span><span class='line'>passwd -l gopher
</span><span class='line'>passwd -l ftp
</span><span class='line'>passwd -l mailnull
</span><span class='line'>passwd -l pcap
</span><span class='line'>passwd -l mail
</span><span class='line'>passwd -l shutdown
</span><span class='line'>passwd -l halt
</span><span class='line'>passwd -l uucp
</span><span class='line'>passwd -l operator
</span><span class='line'>passwd -l sync
</span><span class='line'>passwd -l adm
</span><span class='line'>passwd -l lp
</span><span class='line'>
</span><span class='line'># 用chattr给用户路径更改属性。chattr命令用法参考文末说明[1]
</span><span class='line'>chattr +i /etc/passwd
</span><span class='line'>chattr +i /etc/shadow
</span><span class='line'>chattr +i /etc/group
</span><span class='line'>chattr +i /etc/gshadow
</span><span class='line'>
</span><span class='line'># 设置密码连续输错3次后锁定5分钟
</span><span class='line'>sed -i 's#auth        required      pam_env.so#auth        required      pam_env.so\nauth       required       pam_tally.so  onerr=fail deny=3 unlock_time=300\nauth           required     /lib/security/$ISA/pam_tally.so onerr=fail deny=3 unlock_time=300#' /etc/pam.d/system-auth
</span><span class='line'>
</span><span class='line'># 5分钟后自动登出，原因参考文末说明[2]
</span><span class='line'>echo "TMOUT=300" &gt;&gt;/etc/profile
</span><span class='line'>
</span><span class='line'># 历史命令记录数设定为10条
</span><span class='line'>sed -i "s/HISTSIZE=1000/HISTSIZE=10/" /etc/profile
</span><span class='line'>
</span><span class='line'># 让以上针对 /etc/profile 的改动立即生效
</span><span class='line'>source /etc/profile
</span><span class='line'>
</span><span class='line'># 在 /etc/sysctl.conf 中启用 syncookie
</span><span class='line'>echo "net.ipv4.tcp_syncookies=1" &gt;&gt; /etc/sysctl.conf
</span><span class='line'>sysctl -p # exec sysctl.conf enable
</span><span class='line'>
</span><span class='line'># 优化 sshd_config
</span><span class='line'>sed -i "s/#MaxAuthTries 6/MaxAuthTries 6/" /etc/ssh/sshd_config
</span><span class='line'>sed -i  "s/#UseDNS yes/UseDNS no/" /etc/ssh/sshd_config
</span><span class='line'>
</span><span class='line'># 限制重要命令的权限
</span><span class='line'>chmod 700 /bin/ping
</span><span class='line'>chmod 700 /usr/bin/finger
</span><span class='line'>chmod 700 /usr/bin/who
</span><span class='line'>chmod 700 /usr/bin/w
</span><span class='line'>chmod 700 /usr/bin/locate
</span><span class='line'>chmod 700 /usr/bin/whereis
</span><span class='line'>chmod 700 /sbin/ifconfig
</span><span class='line'>chmod 700 /usr/bin/pico
</span><span class='line'>chmod 700 /bin/vi
</span><span class='line'>chmod 700 /usr/bin/which
</span><span class='line'>chmod 700 /usr/bin/gcc
</span><span class='line'>chmod 700 /usr/bin/make
</span><span class='line'>chmod 700 /bin/rpm
</span><span class='line'>
</span><span class='line'># 历史安全
</span><span class='line'>chattr +a /root/.bash_history
</span><span class='line'>chattr +i /root/.bash_history
</span><span class='line'>
</span><span class='line'># 给重要命令写 md5
</span><span class='line'>cat &gt; list &lt;&lt; "EOF" &&
</span><span class='line'>/bin/ping
</span><span class='line'>/usr/bin/finger
</span><span class='line'>/usr/bin/who
</span><span class='line'>/usr/bin/w
</span><span class='line'>/usr/bin/locate
</span><span class='line'>/usr/bin/whereis
</span><span class='line'>/sbin/ifconfig
</span><span class='line'>/bin/vi
</span><span class='line'>/usr/bin/vim
</span><span class='line'>/usr/bin/which
</span><span class='line'>/usr/bin/gcc
</span><span class='line'>/usr/bin/make
</span><span class='line'>/bin/rpm
</span><span class='line'>EOF
</span><span class='line'>
</span><span class='line'>for i in `cat list`
</span><span class='line'>do
</span><span class='line'>   if [ ! -x $i ];then
</span><span class='line'>   echo "$i not found,no md5sum!"
</span><span class='line'>  else
</span><span class='line'>   md5sum $i &gt;&gt; /var/log/`hostname`.log
</span><span class='line'>  fi
</span><span class='line'>done
</span><span class='line'>rm -f list</span></code></pre></td></tr></table></div></figure>


<!--more-->


<p>知识点[1]：有关chattr命令</p>

<pre><code>   chattr命令可以修改文件属性，达到保护文件和目录的作用。相比改变文件读写、执行权限的chmod命令，chattr命令可以控制更底层的文件属性。该命令十分强大，其中一些功能是由Linux内核版本来支持的，如果Linux内核版本低于2.2，那么许多功能不能实现。同样-D检查压缩文件中的错误的功能，需要2.5.19以上内核才能支持。另外，通过chattr命令修改属性能够提高系统的安全性，但是它并不适合所有的目录。chattr命令不能保护/、/dev、/tmp、/var目录。

  此类属性的查看可以通过lsattr命令完成。

  chattr命令的用法：chattr [ -RV ] [ -v version ] [ mode ] files...

 最关键的是在[mode]部分，，即文件属性部分。[mode]部分是由+-=和[ASacDdIijsTtu]这些字符组合的。

 + ：在原有参数设定基础上，追加参数。

 - ：在原有参数设定基础上，移除参数。

 = ：更新为指定参数设定。

 A：文件或目录的 atime (access time)不可被修改(modified), 可以有效预防例如手提电脑磁盘I/O错误的发生。

 S：硬盘I/O同步选项，功能类似sync。

 a：即append，设定该参数后，只能向文件中添加数据，而不能删除，多用于服务器日志文 件安全，只有root才能设定这个属性。

 c：即compresse，设定文件是否经压缩后再存储。读取时需要经过自动解压操作。

 d：即no dump，设定文件不能成为dump程序的备份目标。

 i：设定文件不能被删除、改名、设定链接关系，同时不能写入或新增内容。i参数对于文件 系统的安全设置有很大帮助。

 j：即journal，设定此参数使得当通过mount参数：data=ordered 或者 data=writeback 挂 载的文件系统，文件在写入时会先被记录(在journal中)。如果filesystem被设定参数为 data=journal，则该参数自动失效。

 s：保密性地删除文件或目录，即硬盘空间被全部收回。

 u：与s相反，当设定为u时，数据内容其实还存在磁盘中，可以用于undeletion.

 各参数选项中常用到的是a和i。a选项强制只可添加不可删除，多用于日志系统的安全设定。而i是更为严格的安全设定，只有superuser (root) 或具有CAP_LINUX_IMMUTABLE处理能力（标识）的进程能够施加该选项。

 应用实例：
 1、用chattr命令防止系统中某个关键文件被修改
</code></pre>

<h1>chattr +i /etc/fstab</h1>

<p>复制代码</p>

<pre><code> 然后试一下rm mv rename等命令操作于该文件，都是得到Operation not permitted 的结果

 2、让某个文件只能往里面追加内容，不能删除，一些日志文件适用于这种操作
</code></pre>

<h1>chattr +a /data1/user_act.log</h1>

<p>复制代码</p>

<pre><code> 知识点[2]：为何要设置5分钟后自动登出

 由于客户的维护人员常常登陆上去后通过直接关闭TERM端口非法退出telnet，造成系统的pts进程越来越多，一个月下来竟然近百，当进程过多的时候系统就会产生报警。规范操作应该是用exit或者ctrl+D，但是其他人并不这样操作，所以我们定义了echo "TMOUT=300" &gt;&gt;/etc/profile这一项内容，是让服务器自动剔除300秒没有任何动作的客户端。当然了这一项大家可以根据实际需求而决定是否添加；
</code></pre>

<p>脚本如果有任何bug或问题，可在51CTO上联系抚琴煮酒，或在<a href="http://www.freebsdsystem.org/%E4%B8%8A%E8%81%94%E7%B3%BB%E6%99%93%E8%BE%89%E3%80%82">http://www.freebsdsystem.org/%E4%B8%8A%E8%81%94%E7%B3%BB%E6%99%93%E8%BE%89%E3%80%82</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[批处理脚本]windows下，PortMap无限运行脚本]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/pi-chu-li-jiao-ben-windowsxia-%2Cportmapwu-xian-yun-xing-jiao-ben/"/>
    <updated>2013-08-29T09:32:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/pi-chu-li-jiao-ben-windowsxia-,portmapwu-xian-yun-xing-jiao-ben</id>
    <content type="html"><![CDATA[<p>该脚本来源于一个肉鸡扫描守护脚本。黑客在获取administrators权限之后，通过恶意脚本篡改注册表，使任务管理器、用户管理器无法正常启动，无法切换console，无法修改系统密码；当合法管理员登陆，只能通过tasklist来打印进程，通过taskkill来杀掉进程；这个脚本就是检测进程是否存在，如果被管理员杀掉之后，会自动启动。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@echo off
</span><span class='line'>setlocal
</span><span class='line'>cls
</span><span class='line'>color f0
</span><span class='line'>mode con: cols=20 lines=5
</span><span class='line'>title 软件监听器
</span><span class='line'>@echo off
</span><span class='line'>:en
</span><span class='line'>tasklist |find "PortMap.exe"||start PortMap.exe
</span><span class='line'>ping -n 10 127.0.0.1&gt;nul
</span><span class='line'>goto en</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pxe安装Centos 6]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/pxean-zhuang-centos-6/"/>
    <updated>2013-08-29T09:24:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/pxean-zhuang-centos-6</id>
    <content type="html"><![CDATA[<p>服务器端：win2003 (win7也可以)，iis（ftp也可以），软件tftpd32，syslinux。
过程如下：
1、在D：盘新建以下目录</p>

<p>D:linux-inst
D:linux-inst\pxelinux.cfg\
2、将CentOS-6.0-x86_64-bin-DVD1.iso挂载到虚拟光驱。
3、打开镜像，把以下文件复制到D:linux-inst\文件夹中。
H:\images\pxeboot\initr.img
H:\images\pxeboot\vmlinux
H:\ isolinux\boot.msg
4、将ISO中的以下文件
H:\isolinux\isolinux.cfg
复制到 D:\linux-inst\pxelinux.cfg\目录中，然后将该文件重命名为“default” 注：default没有后缀名哦。</p>

<p>5、将syslinux-4.04.zip解压，把以下文件拷贝到D:\linux-inst\。
D:\syslinux-4.04\core\pxelinux.0
6、安装dhcp服务器，使用tfpd32，下载zip版本的，直接解压打开设置如下。
   a、设置文件存放目录。</p>

<p>b、设置DHCP，第一项ip池起始地址，这里设为192.168.1.100，第二项ip池个数这里设为5个。BootFile 为pxelinux.0 （必须的）,下一项为服务器地址即本机IP：192.168.1.5 Mask 为255.255.255.0，其余为默认即可。点击OK后，关闭重启。</p>

<p>下面，可以有两种方式:</p>

<pre><code>        1.本地架设HTTP，FTP都可以讲本地镜像加载到虚拟光驱之后，挂载到服务上。
        2.直接加载网络镜像里面的系统问题，推荐一个中国区的http://mirrors.163.com/centos/6/os/x86_64/
</code></pre>

<p>8、设置客户机从PXE启动，如果成功会获取到IP地址并进入boot：。（可能会提示错误，忽略）
9、在boot里面输入linux（为图形安装），输入：linux text （文本模式）。</p>

<p>10、开始进入安装，选择安装媒介的时候选择http，地址栏输入：<a href="ftp://192.168.1.5">ftp://192.168.1.5</a> 如果成功即可开始安装。
备注：
安装过程遇到的问题：
1、如获取不到文件，请尝试关闭防火墙。
2、客服端启动的时候，看到通过DHCP获取到了IP地址，但提示找不到文件。打开Tftpd32中的日志功能，日志显示pxelinux.0有问题。于是重新替换了下，正常了。
3、安装到分区的时候，可能会提示文件repodata/无法找到。 原因是ISO里面的文件名可能和网上发布的repodata/不太一样（没搞懂）。需到mirrors里面去下载repodata/ 目录下的所有文件并替换掉ISO里面repodata/目录。方可成功。</p>

<p>如果网络情况允许的话，建议用163镜像里面的安装</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Centos下调整LVM分区大小]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/centosxia-diao-zheng-lvmfen-qu-da-xiao/"/>
    <updated>2013-08-29T09:21:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/centosxia-diao-zheng-lvmfen-qu-da-xiao</id>
    <content type="html"><![CDATA[<p>1.用df -ahT来查看分区挂载在什么目录上</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@mysql /]# df -ahT
</span><span class='line'>Filesystem    Type    Size  Used Avail Use% Mounted on
</span><span class='line'>/dev/mapper/vg_mysql-lv_root
</span><span class='line'>              ext4     50G  2.4G   45G   5% /
</span><span class='line'>proc          proc       0     0     0   -  /proc
</span><span class='line'>sysfs        sysfs       0     0     0   -  /sys
</span><span class='line'>devpts      devpts       0     0     0   -  /dev/pts
</span><span class='line'>tmpfs        tmpfs     24G     0   24G   0% /dev/shm
</span><span class='line'>/dev/sda1     ext4    485M   37M  423M   8% /boot
</span><span class='line'>none   binfmt_misc       0     0     0   -  /proc/sys/fs/binfmt_misc
</span><span class='line'>sunrpc  rpc_pipefs       0     0     0   -  /var/lib/nfs/rpc_pipefs
</span><span class='line'>/dev/mapper/vg_mysql-lv_home
</span><span class='line'>              ext4     99G  188M   94G   1% /home</span></code></pre></td></tr></table></div></figure>


<!--more-->


<p>2.查看LVM分布情况</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@mysql /]# lvmdiskscan 
</span><span class='line'>  /dev/ram0             [      16.00 MiB] 
</span><span class='line'>  /dev/root             [      50.00 GiB] 
</span><span class='line'>  /dev/ram1             [      16.00 MiB] 
</span><span class='line'>  /dev/sda1             [     500.00 MiB] 
</span><span class='line'>  /dev/vg_mysql/lv_swap [      49.27 GiB] 
</span><span class='line'>  /dev/ram2             [      16.00 MiB] 
</span><span class='line'>  /dev/sda2             [       2.00 TiB] LVM physical volume
</span><span class='line'>  /dev/vg_mysql/lv_home [       1.80 TiB] 
</span><span class='line'>  /dev/ram3             [      16.00 MiB] 
</span><span class='line'>  /dev/ram4             [      16.00 MiB] 
</span><span class='line'>  /dev/ram5             [      16.00 MiB] 
</span><span class='line'>  /dev/ram6             [      16.00 MiB] 
</span><span class='line'>  /dev/ram7             [      16.00 MiB] 
</span><span class='line'>  /dev/ram8             [      16.00 MiB] 
</span><span class='line'>  /dev/ram9             [      16.00 MiB] 
</span><span class='line'>  /dev/ram10            [      16.00 MiB] 
</span><span class='line'>  /dev/ram11            [      16.00 MiB] 
</span><span class='line'>  /dev/ram12            [      16.00 MiB] 
</span><span class='line'>  /dev/ram13            [      16.00 MiB] 
</span><span class='line'>  /dev/ram14            [      16.00 MiB] 
</span><span class='line'>  /dev/ram15            [      16.00 MiB] </span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@mysql /]# lvscan -a
</span><span class='line'>  ACTIVE            '/dev/vg_mysql/lv_root' [50.00 GiB] inherit
</span><span class='line'>  ACTIVE            '/dev/vg_mysql/lv_home' [1.71 TiB] inherit
</span><span class='line'>  ACTIVE            '/dev/vg_mysql/lv_swap' [49.27 GiB] inherit</span></code></pre></td></tr></table></div></figure>


<ol>
<li>将lv_home分区删除并创建新分区</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@mysql /]# lvremove /dev/vg_mysql/lv_home 
</span><span class='line'>Do you really want to remove active logical volume lv_home? [y/n]: y
</span><span class='line'>  Logical volume "lv_home" successfully removed
</span><span class='line'>[root@mysql /]# lvcreate -L 100G -n lv_home vg_mysql
</span><span class='line'>  Logical volume "lv_home" created
</span><span class='line'>[root@mysql /]# mkfs
</span><span class='line'>mkfs          mkfs.cramfs   mkfs.ext2     mkfs.ext3     mkfs.ext4     mkfs.ext4dev  mkfs.msdos    mkfs.vfat     mkfs.xfs      
</span><span class='line'>[root@mysql /]# mkfs.ext
</span><span class='line'>mkfs.ext2     mkfs.ext3     mkfs.ext4     mkfs.ext4dev  
</span><span class='line'>[root@mysql /]# mkfs.ext4 /dev/vg_mysql/lv_home 
</span><span class='line'>mke2fs 1.41.12 (17-May-2010)
</span><span class='line'>Filesystem label=
</span><span class='line'>OS type: Linux
</span><span class='line'>Block size=4096 (log=2)
</span><span class='line'>Fragment size=4096 (log=2)
</span><span class='line'>Stride=0 blocks, Stripe width=0 blocks
</span><span class='line'>6553600 inodes, 26214400 blocks
</span><span class='line'>1310720 blocks (5.00%) reserved for the super user
</span><span class='line'>First data block=0
</span><span class='line'>Maximum filesystem blocks=4294967296
</span><span class='line'>800 block groups
</span><span class='line'>32768 blocks per group, 32768 fragments per group
</span><span class='line'>8192 inodes per group
</span><span class='line'>Superblock backups stored on blocks: 
</span><span class='line'>        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
</span><span class='line'>        4096000, 7962624, 11239424, 20480000, 23887872
</span><span class='line'>
</span><span class='line'>Writing inode tables: done                            
</span><span class='line'>Creating journal (32768 blocks): done
</span><span class='line'>Writing superblocks and filesystem accounting information: moundone
</span><span class='line'>
</span><span class='line'>This filesystem will be automatically checked every 34 mounts or
</span><span class='line'>180 days, whichever comes first.  Use tune2fs -c or -i to override.
</span><span class='line'>        [root@mysql /]# mount /dev/vg_mysql/lv_home /home</span></code></pre></td></tr></table></div></figure>


<p>4.创建新分区data 挂载到/data 文件系统xfs</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@mysql /]# lvcreate -L 1.61T -n data vg_mysql
</span><span class='line'>  Rounding up size to full physical extent 1.61 TiB
</span><span class='line'>  Logical volume "data" created
</span><span class='line'>[root@mysql /]# mkdir /data
</span><span class='line'>
</span><span class='line'>[root@mysql /]# yum install xfsprogs kmod-xfs 
</span><span class='line'>Loaded plugins: fastestmirror, security
</span><span class='line'>Loading mirror speeds from cached hostfile
</span><span class='line'> * base: centos.ustc.edu.cn
</span><span class='line'> * extras: centos.ustc.edu.cn
</span><span class='line'> * updates: centos.ustc.edu.cn
</span><span class='line'>base                                                                                                                                            | 3.7 kB     00:00     
</span><span class='line'>extras                                                                                                                                          | 3.5 kB     00:00     
</span><span class='line'>percona                                                                                                                                         | 1.2 kB     00:00     
</span><span class='line'>updates                                                                                                                                         | 3.5 kB     00:00     
</span><span class='line'>Setting up Install Process
</span><span class='line'>No package kmod-xfs available.
</span><span class='line'>Resolving Dependencies
</span><span class='line'>--&gt; Running transaction check
</span><span class='line'>---&gt; Package xfsprogs.x86_64 0:3.1.1-6.el6 will be installed
</span><span class='line'>--&gt; Finished Dependency Resolution
</span><span class='line'>
</span><span class='line'>Dependencies Resolved
</span><span class='line'>
</span><span class='line'>=======================================================================================================================================================================
</span><span class='line'> Package                                 Arch                                  Version                                       Repository                           Size
</span><span class='line'>=======================================================================================================================================================================
</span><span class='line'>Installing:
</span><span class='line'> xfsprogs                                x86_64                                3.1.1-6.el6                                   base                                723 k
</span><span class='line'>
</span><span class='line'>Transaction Summary
</span><span class='line'>=======================================================================================================================================================================
</span><span class='line'>Install       1 Package(s)
</span><span class='line'>
</span><span class='line'>Total download size: 723 k
</span><span class='line'>Installed size: 3.2 M
</span><span class='line'>Is this ok [y/N]: y
</span><span class='line'>Downloading Packages:
</span><span class='line'>xfsprogs-3.1.1-6.el6.x86_64.rpm                                                                                                                 | 723 kB     00:00     
</span><span class='line'>warning: rpmts_HdrFromFdno: Header V3 RSA/SHA1 Signature, key ID c105b9de: NOKEY
</span><span class='line'>Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6
</span><span class='line'>Importing GPG key 0xC105B9DE:
</span><span class='line'> Userid : CentOS-6 Key (CentOS 6 Official Signing Key) &lt;centos-6-key@centos.org&gt;
</span><span class='line'> Package: centos-release-6-2.el6.centos.7.x86_64 (@anaconda-CentOS-201112091719.x86_64/6.2)
</span><span class='line'> From   : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6
</span><span class='line'>Is this ok [y/N]: y
</span><span class='line'>Running rpm_check_debug
</span><span class='line'>Running Transaction Test
</span><span class='line'>Transaction Test Succeeded
</span><span class='line'>Running Transaction
</span><span class='line'>  Installing : xfsprogs-3.1.1-6.el6.x86_64                                                                                                                         1/1 
</span><span class='line'>
</span><span class='line'>Installed:
</span><span class='line'>  xfsprogs.x86_64 0:3.1.1-6.el6                                                                                                                                        
</span><span class='line'>
</span><span class='line'>Complete!
</span><span class='line'>
</span><span class='line'>[root@mysql /]# mkfs -t xfs /dev/vg_mysql/data
</span><span class='line'>meta-data=/dev/vg_mysql/data     isize=256    agcount=4, agsize=108045312 blks
</span><span class='line'>         =                       sectsz=512   attr=2
</span><span class='line'>data     =                       bsize=4096   blocks=432181248, imaxpct=5
</span><span class='line'>         =                       sunit=0      swidth=0 blks
</span><span class='line'>naming   =version 2              bsize=4096   ascii-ci=0
</span><span class='line'>log      =internal log           bsize=4096   blocks=211026, version=2
</span><span class='line'>         =                       sectsz=512   sunit=0 blks, lazy-count=1
</span><span class='line'>realtime =none                   extsz=4096   blocks=0, rtextents=0
</span><span class='line'>
</span><span class='line'>[root@mysql /]# lvscan -a
</span><span class='line'>  ACTIVE            '/dev/vg_mysql/lv_root' [50.00 GiB] inherit
</span><span class='line'>  ACTIVE            '/dev/vg_mysql/lv_home' [99.61 GiB] inherit
</span><span class='line'>  ACTIVE            '/dev/vg_mysql/lv_swap' [49.27 GiB] inherit
</span><span class='line'>  ACTIVE            '/dev/vg_mysql/data' [1.61 TiB] inherit
</span><span class='line'>
</span><span class='line'>[root@mysql /]# mount /dev/vg_mysql/data /data
</span><span class='line'>
</span><span class='line'>[root@mysql /]# df -ahT
</span><span class='line'>Filesystem    Type    Size  Used Avail Use% Mounted on
</span><span class='line'>/dev/mapper/vg_mysql-lv_root
</span><span class='line'>              ext4     50G  2.4G   45G   5% /
</span><span class='line'>proc          proc       0     0     0   -  /proc
</span><span class='line'>sysfs        sysfs       0     0     0   -  /sys
</span><span class='line'>devpts      devpts       0     0     0   -  /dev/pts
</span><span class='line'>tmpfs        tmpfs     24G     0   24G   0% /dev/shm
</span><span class='line'>/dev/sda1     ext4    485M   37M  423M   8% /boot
</span><span class='line'>none   binfmt_misc       0     0     0   -  /proc/sys/fs/binfmt_misc
</span><span class='line'>sunrpc  rpc_pipefs       0     0     0   -  /var/lib/nfs/rpc_pipefs
</span><span class='line'>/dev/mapper/vg_mysql-data
</span><span class='line'>               xfs    1.7T   33M  1.7T   1% /data</span></code></pre></td></tr></table></div></figure>


<p>在配置文件里面添加</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vim /etc/fstab
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>#
</span><span class='line'># /etc/fstab
</span><span class='line'># Created by anaconda on Wed May 18 23:08:57 2011
</span><span class='line'>#
</span><span class='line'># Accessible filesystems, by reference, are maintained under '/dev/disk'
</span><span class='line'># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
</span><span class='line'>#
</span><span class='line'>/dev/mapper/vg_mysql-lv_root /                       ext4    defaults        1 1
</span><span class='line'>UUID=5ea38281-5e14-4d2e-9bd4-202d9e6dfdc2 /boot                   ext4    defaults        1 2
</span><span class='line'>/dev/vg_mysql/lv_home  /home                   ext4    defaults        1 2
</span><span class='line'>/dev/mapper/vg_mysql-lv_swap swap                    swap    defaults        0 0
</span><span class='line'>/dev/vg_mysql/data   /data                                   xfs     defaults        0 0
</span><span class='line'>tmpfs                   /dev/shm                tmpfs   defaults        0 0
</span><span class='line'>devpts                  /dev/pts                devpts  gid=5,mode=620  0 0
</span><span class='line'>sysfs                   /sys                    sysfs   defaults        0 0
</span><span class='line'>proc                    /proc                   proc    defaults        0 0</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[开启JVM的SNMP]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/kai-qi-jvmde-snmp/"/>
    <updated>2013-08-29T09:19:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/kai-qi-jvmde-snmp</id>
    <content type="html"><![CDATA[<p>在jdk1.6.0_12\jre\lib\management目录中找到management.properties文件（如果没有可以创建一个）如果目录中有这个文件一般情况下里面都是帮助文档，英文好的直接看里面说明。可以掠过我的文章。英文不好的，按部就班的跟我来。
1、删除所有内容留下两句话：
com.sun.management.snmp.interface=0.0.0.0
com.sun.management.snmp.acl.file=jdk1.6.0_12/jre/lib/management/snmp.acl
这两行的意思是，允许jvm的snmp agent监听所有网卡，并且指定acl文件的位置。
2、按照prperties文件指定的位置，新建一个snmp.acl文件。
内容如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#The communities public and private are allowed access from the local host.
</span><span class='line'>acl = {
</span><span class='line'>        {
</span><span class='line'>          communities = public, private
</span><span class='line'>          access = read-only
</span><span class='line'>          managers = cactihostip
</span><span class='line'>        }
</span><span class='line'>}
</span><span class='line'># Traps are sent to localhost only
</span><span class='line'>trap = {
</span><span class='line'>          {
</span><span class='line'>            trap-community = public
</span><span class='line'>            hosts = cactihostip
</span><span class='line'>          }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>作用，是对获取snmp信息的机器IP进行限制。只有managers一行指定的IP才能够获取snmp信息
3、启动JVM时候加上-Dcom.sun.management.snmp.port=1161这个参数。指定jvm的snmp agent工作在1161端口上。（当然端口号可以根据自己的情况修改，不要端口冲突哦）
4、修改management.properties和snmp.acl两个文件的权限，都修改成600，并将文件的属主修改成运行jvm的用户。（NTFS盘的话，需要把这两个文件只读，并把其他权限去除，否则会无法访问。）
这时，再启动jvm，并且用netstat查看，如果正常的话，就会发现已经有程序监听在1161端口上。
这个方法WINDOWS和LINUX通用，注意路径即可。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CentOS 64bit密码正确却无法登录init 3]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/centos-64bitmi-ma-zheng-que-que-wu-fa-deng-lu-init-3/"/>
    <updated>2013-08-29T09:18:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/centos-64bitmi-ma-zheng-que-que-wu-fa-deng-lu-init-3</id>
    <content type="html"><![CDATA[<p>登陆界面输入正确的账号密码会重新返回登陆界面且没有任何提示，
输入错误的账号密码会提示账号密码错误。解决方法方法：
重启电脑进入单用户模式
vi /etc/pam.d/login
将如下行：
session required /lib/security/pam_limits.so
换成：
session required /lib64/security/pam_limits.so
重启，故障排除。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[centos日常工作故障排除]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/centosri-chang-gong-zuo-gu-zhang-pai-chu/"/>
    <updated>2013-08-29T09:16:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/centosri-chang-gong-zuo-gu-zhang-pai-chu</id>
    <content type="html"><![CDATA[<p>2012年6月25日</p>

<pre><code>   下午接到保障，说新装的一台mysql服务器SSH连不上，去机房连上服务器看下，机器硬件没有问题正常工作，指示灯全部正常；登陆界面输入用户名密码之后，没有进入命令行模式，直接退回到登陆界面，这个是密码输入正确的情况下，密码输入错误回报警，说明登陆严重环节没有问题，应该是登陆控制的问题，把本地登陆给屏蔽了。查询相关资料之后，找到问题的原因，由于/etc/pam.d/login文件里面添加了控制库。
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@mysql ~]# more /etc/pam.d/login 
</span><span class='line'>#%PAM-1.0
</span><span class='line'>auth [user_unknown=ignore success=ok ignore=ignore default=bad] pam_securetty.so
</span><span class='line'>auth       include      system-auth
</span><span class='line'>account    required     pam_nologin.so
</span><span class='line'>account    include      system-auth
</span><span class='line'>password   include      system-auth
</span><span class='line'># pam_selinux.so close should be the first session rule
</span><span class='line'>session    required     pam_selinux.so close
</span><span class='line'>session    required     pam_loginuid.so
</span><span class='line'>session    optional     pam_console.so
</span><span class='line'>session    required     /lib64/security/pam_limits.so
</span><span class='line'># pam_selinux.so open should only be followed by sessions to be executed in the 
</span><span class='line'>user context
</span><span class='line'>session    required     pam_selinux.so open
</span><span class='line'>session    required     pam_namespace.so
</span><span class='line'>session    optional     pam_keyinit.so force revoke
</span><span class='line'>session    include      system-auth
</span><span class='line'>-session   optional     pam_ck_connector.so</span></code></pre></td></tr></table></div></figure>


<p>黄色背景的一行是故障点，在进入单用户模式的时候这行是“session    required     /lib/security/pam_limits.so”，指向的是32位的目录，将目录修改成代码框里的之后重启，登陆正常。</p>

<pre><code>    进入系统之后，查看网卡状态，正常ETH0启动，ping其他主机也是通的，以为正常从机房出来，到工作机上测试，还是连不上，ping不通，ssh不通；以为是iptables阻止了，去机房把iptables策略全部清空，继续ping其他主机还是通的，但是ssh连接其他主机是不通的，然后arp -a查看，arp表竟然是空的，route查看路由192.168.75.1竟然绑定在lo上面，打开ifcfg-lo文件，IPADDR上面赫然显示192.168.75.102，问题找到了，将lo配置文件还原，重启network服务，系统正常了。
    下面就是排查是操作时上面时候进行的
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@mysql ~]# history |grep -B10 "ifcfg-lo"
</span><span class='line'>  472  2012-06-26_09:36:30 ipconfig --help
</span><span class='line'>  473  2012-06-26_09:36:30 cd etc/syscofig
</span><span class='line'>  474  2012-06-26_09:36:30 ls
</span><span class='line'>  475  2012-06-26_09:36:30 cd ..
</span><span class='line'>  476  2012-06-26_09:36:30 ls
</span><span class='line'>  477  2012-06-26_09:36:30 cd etc
</span><span class='line'>  478  2012-06-26_09:36:30 cd sysconfig
</span><span class='line'>  479  2012-06-26_09:36:30 ls
</span><span class='line'>  480  2012-06-26_09:36:30 cd network-scripts
</span><span class='line'>  481  2012-06-26_09:36:30 ls
</span><span class='line'>  482  2012-06-26_09:36:30 vi ifcfg-lo</span></code></pre></td></tr></table></div></figure>


<p>上面是查询结果，这里解释下，前面的时间戳是故障发生之后才配置的，所以这个时间是不准的，但是已经找到了修改文件的命令，而且可以看出来这个修改的人对centos的网络配置文件目录不是太熟悉，为以后排查人员提供一些佐证，接下来就是查看日志文件，看故障点之前谁登陆过系统。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>more /var/log/secure</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Jun 25 12:17:29 mysql sshd[30293]: Accepted publickey for root from 192.168.***.21 port 24940 ssh2
</span><span class='line'>Jun 25 12:17:29 mysql sshd[30293]: pam_unix(sshd:session): session opened for user root by (uid=0)
</span><span class='line'>Jun 25 12:17:51 mysql sshd[30343]: Accepted publickey for root from 192.168.***.21 port 24942 ssh2
</span><span class='line'>Jun 25 12:17:51 mysql sshd[30343]: pam_unix(sshd:session): session opened for user root by (uid=0)
</span><span class='line'>Jun 25 12:17:51 mysql sshd[30343]: Received disconnect from 192.168.***.21: 11: disconnected by user
</span><span class='line'>Jun 25 12:17:51 mysql sshd[30343]: pam_unix(sshd:session): session closed for user root
</span><span class='line'>Jun 25 13:02:20 mysql sshd[31813]: Accepted password for root from 192.168.***.117 port 4878 ssh2
</span><span class='line'>Jun 25 13:02:20 mysql sshd[31813]: pam_unix(sshd:session): session opened for user root by (uid=0)
</span><span class='line'>Jun 25 13:13:18 mysql sshd[31813]: pam_unix(sshd:session): session closed for user root
</span><span class='line'>Jun 25 13:21:47 mysql sshd[30293]: pam_unix(sshd:session): session closed for user root
</span><span class='line'>Jun 25 13:25:07 mysql login: PAM unable to dlopen(/lib/security/pam_limits.so): /lib/security/pam_limits.so: cannot open shared object file: N
</span><span class='line'>o such file or directory
</span><span class='line'>Jun 25 13:25:07 mysql login: PAM adding faulty module: /lib/security/pam_limits.so
</span><span class='line'>Jun 25 13:25:09 mysql login: pam_unix(login:session): session opened for user root by LOGIN(uid=0)
</span><span class='line'>Jun 25 13:25:09 mysql login: Module is unknown</span></code></pre></td></tr></table></div></figure>


<p>在故障最后登陆的几个IP地址，上面几个是软件测试的IP地址，正在测试软件部署，最后一个IP登陆之后所有的连接全部开，
而且从命令行的使用熟练度来讲，前面几个不会出现目录都不知道在哪里的情况，最后一个IP嫌疑比较大。</p>

<pre><code> 后面就是找办公网来确认IP地址登记的使用者了。
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux基础：让history记录命令的历史执行时间]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/linuxji-chu-%3Arang-historyji-lu-ming-ling-de-li-shi-zhi-xing-shi-jian/"/>
    <updated>2013-08-29T09:12:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/linuxji-chu-:rang-historyji-lu-ming-ling-de-li-shi-zhi-xing-shi-jian</id>
    <content type="html"><![CDATA[<p>缺省情况，我们在Linux查看历史记录命令，后面是无任何执行时间显示的</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>history</span></code></pre></td></tr></table></div></figure>


<p>那么如果想要用到记录命令的执行时间，可以这么操作：</p>

<h1>编辑/etc/bashrc，添加以下内容</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vim /etc/bashrc</span></code></pre></td></tr></table></div></figure>


<h1>让系统记录每条历史命令的执行时间。注意最后的&#8221;号前面要放个空格</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export HISTTIMEFORMAT="%Y-%m-%d_%H:%M:%S "</span></code></pre></td></tr></table></div></figure>


<h1>设置保存历史命令的文件大小</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export HISFILESIZE=1000000</span></code></pre></td></tr></table></div></figure>


<h1>保存历史命令条数</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export HISTSIZE=2000</span></code></pre></td></tr></table></div></figure>


<h1>执行下面的命令使配置立即生效</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>source /etc/bashrc</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[shell比较两个文档，输出不同]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/shellbi-jiao-liang-ge-wen-dang-%2Cshu-chu-bu-tong/"/>
    <updated>2013-08-29T09:08:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/shellbi-jiao-liang-ge-wen-dang-,shu-chu-bu-tong</id>
    <content type="html"><![CDATA[<p>今天，同事想找出短信分发机和平台注册SIM卡的差距，将两个平台的SIM卡分别存到两个文件，本来说是想再数据库里面，通过数据库的函数来做比较，正好最近在学SHELL，想用shell写个脚本来实现。</p>

<pre><code>    以下为几个不同实现方法。
</code></pre>

<p>方法一：使用grep</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>grep -v -f file1 file2 && grep -v -f file2 file1 </span></code></pre></td></tr></table></div></figure>


<p>grep命令的详细使用方法，可以参考man，这里有一个简单实用的介绍：<a href="http://linux.ccidnet.com/art/3067/20070313/1035613_1.html%E3%80%82">http://linux.ccidnet.com/art/3067/20070313/1035613_1.html%E3%80%82</a>
 在方法一中，用到了两个参数。参数-v，表示invert match，即反向匹配，输出没有匹配上的项。参数-f，表示从文件中读取匹配模板(pattern)。方法一中的前一部分，在文件file1中匹配模板，来反向匹配文件file2中的内容，即输出文件file2中，在file1中没有的内容。后面的一部分同理可得，输出文件file1中，在file2中没有的内容。</p>

<p> 2.方法二：实用comm</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>comm -3 file1 file2</span></code></pre></td></tr></table></div></figure>


<p> 这个方法看起来最简单。命令comm的功能就是，逐行比较两个排好序的文件，默认输出有三列：只在file1中有的行、只在file2中有的行、在file1和file2中共有的行。有参数-1 -2 -3，分别来抑制输出对应的列。例如在我们的方法二中，实用-3参数，不输出file1和file2中共有的部分。即能达到我们本文的目的。</p>

<p>3.方法三：使用awk</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>awk '{print NR, $0}' file1 file2 |sort -k2|uniq -u -f 1|sort -k1|awk '{print $2}'
</span><span class='line'>或者：
</span><span class='line'>awk '{print $0}' file1 file2 |sort|uniq -u</span></code></pre></td></tr></table></div></figure>


<p>awk命令的使用，听牛人说可谓博大精深，我也没有太搞清楚。这里只是使用了一些简单的功能。下面以我自己的理解来解释一下上面的shell代码。awk就是文本的解释器和过滤器。awk把每一行看成是一个记录(record)，每个记录使用分隔符(默认是空格)把每条记录分成若干域。awk内置参数$0表示整行，$1、$2&hellip;分别表示各域，内置参数NR，表示记录的计数，awk &lsquo;{print NR, $0}&rsquo; file1 file2表示依次读取file1 file2，打印出每行，并且在前面添加行号。
 命令sort，就是对行进行排序，参数-k表示根据各行的第几个参数关键字开进行排序，这里的-k2表示根据第二个关键字开始进行排序。
 命令uniq，进行报告或者忽略重复的行，参数-u，表示只是打印出唯一的行(unique lines)，-f表示忽略的每行的前n个域的比较。</p>

<p>4.方法四：使用for、grep</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for i in `cat new.ods`;do cat old.ods|grep $i &gt; /dev/null ||echo $i ;done;</span></code></pre></td></tr></table></div></figure>


<p>找出文件new里面有得old里面不存在的</p>

<p>总的来说，几个方法我都使用了，前面三个都是找出两边所有不同的，第一个grep效率低点，最高的还是第四个，比较好用，筛选出来的数据还可以反复验证下，比较好用。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>comm -12 fileA fileB</span></code></pre></td></tr></table></div></figure>


<p>比较文件，输出两个文件相同数据。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux修改snmp的默认监听端口]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/linuxxiu-gai-snmpde-mo-ren-jian-ting-duan-kou/"/>
    <updated>2013-08-29T09:07:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/linuxxiu-gai-snmpde-mo-ren-jian-ting-duan-kou</id>
    <content type="html"><![CDATA[<p>snmpd默认在udp161上监听SNMP请求，处于安全考虑，我们可能希望改变端口，可以通过给snmpd指定监听端口。</p>

<p>修改snmp启动配置文件 /etc/init.d/snmpd</p>

<p>修改前 OPTIONS=&ldquo;-Lsd -Lf /dev/null -p /var/run/snmpd.pid -a&rdquo;
修改后 OPTIONS=&ldquo; udp:9999 -Lsd -Lf /dev/null -p /var/run/snmpd.pid -a&rdquo;</p>

<p>最后重启snmp就行了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[VMware vSphere PowerCLI 因为在此系统中禁止执行脚本]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/vmware-vsphere-powercli-yin-wei-zai-ci-xi-tong-zhong-jin-zhi-zhi-xing-jiao-ben/"/>
    <updated>2013-08-29T09:06:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/vmware-vsphere-powercli-yin-wei-zai-ci-xi-tong-zhong-jin-zhi-zhi-xing-jiao-ben</id>
    <content type="html"><![CDATA[<p>VMware vSphere PowerCLI 因为在此系统中禁止执行脚本。有关详细信息，请参阅 &ldquo;get-help about_signi
打开 VMware vSphere PowerCLI 出现
无法加载文件 C:\Program Files (x86)\VMware\Infrastructure\vSphere PowerCLI\Scripts\Initialize-PowerCLIEnvironment.ps1，因为在此系统中禁止执行脚本。有关详细信息，请参阅 &#8220;get-help about_signing&#8221;。所在位置 行:1 字符: 2
+ . &lt;&lt;&lt;&lt;  &#8220;C:\Program Files (x86)\VMware\Infrastructure\vSphere PowerCLI\Script
s\Initialize-PowerCLIEnvironment.ps1&rdquo;</p>

<pre><code>+ CategoryInfo          : NotSpecified: (:) [], PSSecurityException
+ FullyQualifiedErrorId : RuntimeException
</code></pre>

<p>执行：get-help about_signing 命令</p>

<p>执行：get-executionpolicy 命令查看 策略
显示为:  Restricted    该策略不允许任何脚本运行。</p>

<p>执行： set-executionpolicy remotesigned  修改执行策略。</p>

<p>输入： y</p>

<p>退出在打开时候，显示正常</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PowerCLI 批量创建虚拟机]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/powercli-pi-liang-chuang-jian-xu-ni-ji/"/>
    <updated>2013-08-29T09:05:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/powercli-pi-liang-chuang-jian-xu-ni-ji</id>
    <content type="html"><![CDATA[<p>首先，创建一个虚拟机的配置</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PS D:\Program Files (x86)\VMware&gt; New-OSCustomizationSpec -Name testByAVA -OSType Linux -NamingScheme vm -Domain avarcher.net -DnsServer 8.8.8.8</span></code></pre></td></tr></table></div></figure>


<p>添加一个名字为testByAVA，类型为linux的主机的策略。</p>

<p>第二部，创建脚本</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$vmhost="10.1.128.235"
</span><span class='line'>$template="XGTEMP"
</span><span class='line'>$datastore="datastore05"
</span><span class='line'>$custsysprep = Get-OSCustomizationSpec
</span><span class='line'>1..2 | Foreach {
</span><span class='line'>$ip=30
</span><span class='line'>$name="XG13"
</span><span class='line'>$ip=$ip+$_
</span><span class='line'>$name=$name+$_
</span><span class='line'>$custsysprep | Get-OSCustomizationNicMapping |Set-OSCustomizationNicMapping -IpMode UseStaticIP -IpAddress 10.1.128.1$ip -SubnetMask 255.255.254.0 -DefaultGateway 10.1.128.2
</span><span class='line'>New-vm -vmhost $vmhost -Name $name -Template $template -Datastore $datastore -OSCustomizationspec $custsysprep
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>在模板的时候，在虚拟机的
/etc/rc.d/rc.local文件下   添加一句</p>

<p>service network  restart</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SSH通道批量管理主机]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/sshtong-dao-pi-liang-guan-li-zhu-ji/"/>
    <updated>2013-08-29T09:04:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/sshtong-dao-pi-liang-guan-li-zhu-ji</id>
    <content type="html"><![CDATA[<p>这边用到了expect，先yum装下。</p>

<p>下面是一个类似自动输入的方法</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/expect -f
</span><span class='line'>set user root
</span><span class='line'>set host [lindex $argv 0]
</span><span class='line'>set password "*******"
</span><span class='line'>set timeout 5
</span><span class='line'>spawn ssh-copy-id -i  /root/.ssh/id_rsa.pub $user@$host
</span><span class='line'>expect {
</span><span class='line'>
</span><span class='line'>"Are you sure you want to continue connecting (yes/no)?" {send "yes\r";exp_continue}
</span><span class='line'>"*assword:*" {send "$password\r"}
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>expect eof</span></code></pre></td></tr></table></div></figure>


<p>下面就是发送批量指令方法</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/bash
</span><span class='line'>
</span><span class='line'># auto copy publick key to ssh server,but you must create the rsa public key first!
</span><span class='line'>
</span><span class='line'>#
</span><span class='line'>
</span><span class='line'># include a  expect expect script
</span><span class='line'>
</span><span class='line'># see the log file  /tmp/test.log
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>if
</span><span class='line'> rpm -q expect
</span><span class='line'>then
</span><span class='line'> echo "good" &gt;/dev/null
</span><span class='line'>else
</span><span class='line'> ehco "you must install the expect package"
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>for i in {11..29}
</span><span class='line'>
</span><span class='line'>do
</span><span class='line'>
</span><span class='line'>#if
</span><span class='line'>
</span><span class='line'>ping -c2 10.1.128.$i
</span><span class='line'>
</span><span class='line'>#then
</span><span class='line'>
</span><span class='line'>/tmp/abc.sh 10.1.128.$i
</span><span class='line'>
</span><span class='line'>echo "********10.1.128.$i**************"&gt;&gt;/tmp/test.log
</span><span class='line'>
</span><span class='line'>#ssh 10.1.128.$i "chkconfig --level 123456 NetworkManager off"
</span><span class='line'>
</span><span class='line'>ssh 10.1.128.$i " cp /etc/sysconfig/network-scripts/ifcfg-eth1 /etc/sysconfig/network-scripts/ifcfg-eth1.bak"
</span><span class='line'>#else
</span><span class='line'>
</span><span class='line'>#echo "the server 10.1.128.$i is't exsit"&gt;&gt;/tmp/down.log</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PowerCLI抓取虚拟机列表并输出为csv格式]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/powerclizhua-qu-xu-ni-ji-lie-biao-bing-shu-chu-wei-csvge-shi/"/>
    <updated>2013-08-29T09:01:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/powerclizhua-qu-xu-ni-ji-lie-biao-bing-shu-chu-wei-csvge-shi</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Get-VM | Select-Object Name,NumCPU,MemoryMB,PowerState,Host | Export-Csv VMsList.csv -NoTypeInformation</span></code></pre></td></tr></table></div></figure>


<p>该命令不需要连接到vcs上面，直接连vmhost即可。
下面为查询结果</p>

<!--more-->


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Name NumCpu  MemoryMB    PowerState  Host
</span><span class='line'>xg011 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg012 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg013 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg014 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg015 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg016 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg017 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg018 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg019 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg020 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg021 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg022 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg023 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg024 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg025 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg026 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg027 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg028 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg029 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg030 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231
</span><span class='line'>xg010 
</span><span class='line'>2
</span><span class='line'>1024
</span><span class='line'>PoweredOn 10.1.128.231</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PowerCLI获取ESXi主机的硬件配置信息 ]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/powerclihuo-qu-esxizhu-ji-de-ying-jian-pei-zhi-xin-xi/"/>
    <updated>2013-08-29T09:00:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/powerclihuo-qu-esxizhu-ji-de-ying-jian-pei-zhi-xin-xi</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Get-VmHost | Get-View | ForEach-Object
</span><span class='line'>{
</span><span class='line'>$_.Summary.Hardware | Add-Member -MemberType NoteProperty -Name "Name" -Value $_.Name -PassThru
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>查询vmhost物理机一件配置</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PowerCLI D:\Program Files (x86)\VMware&gt; Get-VmHost | Get-View | ForEach-Object{$_.Summary.Hardware | Add-Member -MemberType NotePr
</span><span class='line'>operty -Name "Name" -Value $_.Name -PassThru}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Name                 : localhost.
</span><span class='line'>Vendor               : IBM
</span><span class='line'>Model                : BladeCenter **********
</span><span class='line'>Uuid                 : ***************************
</span><span class='line'>OtherIdentifyingInfo : {VMware.Vim.HostSystemIdentificationInfo}
</span><span class='line'>MemorySize           : *****************
</span><span class='line'>CpuModel             : *****************
</span><span class='line'>CpuMhz               : ******
</span><span class='line'>NumCpuPkgs           : 2
</span><span class='line'>NumCpuCores          : 12
</span><span class='line'>NumCpuThreads        : 24
</span><span class='line'>NumNics              : 7
</span><span class='line'>NumHBAs              : 3
</span><span class='line'>DynamicType          :
</span><span class='line'>DynamicProperty      :</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[shell提取日志中SQL脚本]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/shellti-qu-ri-zhi-zhong-sqljiao-ben/"/>
    <updated>2013-08-29T08:58:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/shellti-qu-ri-zhi-zhong-sqljiao-ben</id>
    <content type="html"><![CDATA[<p>首先，贴出日志中记录的原始数据</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[551067620][SQLProc_4][ERROR] 2012-08-01 00:00:00,491 method:com.jsgps.taxi.dbserver.SQLProc.run(SQLProc.java:104) 批处理执行错误 SQL：Insert into ******************(VT_ID,VT_VEHICL
</span><span class='line'>E ,VT_DATE ,VT_LONG ,VT_LAT ,VT_STATE,VT_SPEED ,VT_DIR,VC_ACC ,VC_LOCK, VC_SYSDATE,vt_enclat,vt_enclon,YC_UNIQUENO) VALUES (VEHICLETRACEID.NEXTVAL, ***********,to_date('201207312
</span><span class='line'>35953','yyyymmddhh24miss'),1.11036653E8,3.8133295E7,7,0,0,1,0,SYSDATE,38.1339830186632,111.042938368056, '********************' )
</span><span class='line'>java.sql.BatchUpdateException: 批处理中出现错误: ORA-00942: 表或视图不存在
</span><span class='line'>
</span><span class='line'>        at oracle.jdbc.dbaccess.DBError.throwBatchUpdateException(DBError.java:572)
</span><span class='line'>        at oracle.jdbc.dbaccess.DBError.throwBatchUpdateException(DBError.java:627)
</span><span class='line'>        at oracle.jdbc.driver.OracleStatement.executeBatch(OracleStatement.java:7101)
</span><span class='line'>        at com.mchange.v2.c3p0.impl.NewProxyStatement.executeBatch(NewProxyStatement.java:743)
</span><span class='line'>        at com.jsgps.taxi.dbserver.SQLProc.run(SQLProc.java:93)
</span><span class='line'>        at java.lang.Thread.run(Unknown Source)</span></code></pre></td></tr></table></div></figure>


<p>处理脚本</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat *  |awk -F'：' '{print $2}'| sed 's/ )/ );/g' |sed 's/0)/0);/g'</span></code></pre></td></tr></table></div></figure>


<p>处置后结果</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Insert into ****************(VT_ID,VT_VEHICLE ,VT_DATE ,VT_LONG ,VT_LAT ,VT_SPEED ,VT_DIR,VC_ACC ,VC_LOCK, VC_LOCK2, VC_LOCK3, vt_enclat,vt_enclon,VC_SYSDATE, YC_UNIQUENO) VALUES (VEHICLETRACEID.NEXTVAL, *************,to_date('20120731235904','yyyymmddhh24miss'),121097185,28873533,0,50,1,0,0,0,28.8707400173611,121.101614312066,SYSDATE, '*****************' );</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PowerCLI获取主机CPU]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/powerclihuo-qu-zhu-ji-cpu/"/>
    <updated>2013-08-29T08:57:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/powerclihuo-qu-zhu-ji-cpu</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$allvms = @()
</span><span class='line'>$vms = Get-Vm
</span><span class='line'>foreach($vm in $vms){
</span><span class='line'>  $vmstat = "" | Select VmName, GuestName, NumCPU, ProvisionedSpaceGB, UsedSpaceGB, VmHost, MemMax, MemAvg, CPUMax, CPUAvg, DiskMax, DiskAvg 
</span><span class='line'>  $vmstat.VmName = $vm.name
</span><span class='line'>  $vmstat.GuestName = $vm.Guest.HostName 
</span><span class='line'>  $vmstat.NumCPU = $vm.NumCPU
</span><span class='line'>  $vmstat.ProvisionedSpaceGB = $vm.ProvisionedSpaceGB
</span><span class='line'>  $vmstat.UsedSpaceGB = $vm.UsedSpaceGB
</span><span class='line'>  $vmstat.VmHost = $vm.VMHost
</span><span class='line'>  
</span><span class='line'>  $statcpu = Get-Stat -Entity ($vm) `
</span><span class='line'>           -start (get-date).AddDays(-30) `
</span><span class='line'>           -Finish (Get-Date) `
</span><span class='line'>             -stat cpu.usagemhz.average
</span><span class='line'>  $statmem = Get-Stat -Entity ($vm) `
</span><span class='line'>           -Start (get-date).AddDays(-30) `
</span><span class='line'>           -Finish (Get-Date) `
</span><span class='line'>             -stat mem.consumed.average
</span><span class='line'>  $statdisk = Get-Stat -Entity ($vm) `
</span><span class='line'>           -Start (get-date).AddDays(-30) `
</span><span class='line'>           -Finish (Get-Date) `
</span><span class='line'>             -stat disk.usage.average
</span><span class='line'>
</span><span class='line'>  $cpu = $statcpu | Measure-Object -Property value -Average -Maximum
</span><span class='line'>  $mem = $statmem | Measure-Object -Property value -Average -Maximum
</span><span class='line'>  $disk = $statdisk | Measure-Object -Property value -Average -Maximum
</span><span class='line'>  
</span><span class='line'>  $vmstat.CPUMax = $cpu.Maximum
</span><span class='line'>  $vmstat.CPUAvg = $cpu.Average
</span><span class='line'>  $vmstat.MemMax = $mem.Maximum
</span><span class='line'>  $vmstat.MemAvg = $mem.Average
</span><span class='line'>  $vmstat.DiskMax = $disk.Maximum
</span><span class='line'>  $vmstat.DiskAvg = $disk.Average
</span><span class='line'>  
</span><span class='line'>  $allvms += $vmstat
</span><span class='line'>}
</span><span class='line'>$allvms | Export-Csv "VMs.csv" -noTypeInformation -UseCulture</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[shell注意点]]></title>
    <link href="http://Ghostbaby.github.io/blog/2013/08/29/shellzhu-yi-dian/"/>
    <updated>2013-08-29T08:56:00+08:00</updated>
    <id>http://Ghostbaby.github.io/blog/2013/08/29/shellzhu-yi-dian</id>
    <content type="html"><![CDATA[<p>1.默认情况下，未定义的变量展开为null，即为空，所以在使用变量时要尤其小心，如下的语句可能会导致灾难</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rm -rf /$abc</span></code></pre></td></tr></table></div></figure>


<p>如果此时变量abc取不到值，后果不堪设想。</p>
]]></content>
  </entry>
  
</feed>
